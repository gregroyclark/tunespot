{"version":3,"sources":["Login.js","Player.js","TrackSearchResult.js","Dashboard.js","useAuth.js","App.js","index.js"],"names":["Login","Container","className","style","minHeight","href","Player","accessToken","trackUri","useState","play","setPlay","useEffect","token","showSaveIcon","callback","state","isPlaying","uris","TrackSearchResult","track","chooseTrack","cursor","onClick","src","albumUrl","height","width","alt","title","artist","require","config","spotifyApi","SpotifyWebApi","clientId","process","CLIENT_ID","Dashboard","code","setAccessToken","refreshToken","setRefreshToken","expiresIn","setExpiresIn","axios","post","then","res","data","window","history","pushState","catch","location","interval","setInterval","clearInterval","useAuth","search","setSearch","searchResults","setSearchResults","playingTrack","setPlayingTrack","lyrics","setLyrics","get","params","cancel","searchTracks","body","tracks","items","map","smallestAlbumImage","album","images","reduce","smallest","image","artists","name","uri","url","Form","Control","type","placeholder","value","onChange","e","target","overflowY","length","whiteSpace","URLSearchParams","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.1c0f305e.chunk.js","sourcesContent":["import React from 'react';\nimport { Container } from 'react-bootstrap';\n\nconst AUTH_URL =\n\t'https://accounts.spotify.com/authorize?client_id=66fc5169a39843ad81b3cb835da6a3b5&response_type=code&redirect_uri=https://tunespot.herokuapp.com&scope=streaming%20user-read-email%20user-read-private%20user-library-read%20user-library-modify%20user-read-playback-state%20user-modify-playback-state';\n\nexport default function Login() {\n\treturn (\n\t\t<Container\n\t\t\tclassName=\"d-flex justify-content-center align-items-center\"\n\t\t\tstyle={{ minHeight: '100vh' }}\n\t\t>\n\t\t\t<a className=\"btn btn-success btn-lg\" href={AUTH_URL}>\n\t\t\t\tLogin With Spotify\n\t\t\t</a>\n\t\t</Container>\n\t);\n}\n","import { useState, useEffect } from 'react';\nimport SpotifyPlayer from 'react-spotify-web-playback'\n\nexport default function Player({ accessToken, trackUri }) {\n    const [play, setPlay] = useState(false)\n\n    useEffect(() => setPlay(true), [trackUri])\n\n    if (!accessToken) return null\n    return (\n        <SpotifyPlayer \n        token={accessToken}\n        showSaveIcon\n        callback={state => {\n            if (!state.isPlaying) setPlay(false)\n        }}\n        play={play}\n        uris={trackUri ? [trackUri] : []}\n        />\n    )\n}","import React from 'react';\n\nexport default function TrackSearchResult({ track, chooseTrack }) {\n    function handlePlay() {\n        chooseTrack(track)\n    }\n    \n    return (\n        <div className=\"d-flex m-2 align-items-center\"\n        style={{ cursor: 'pointer'}}\n        onClick={handlePlay}\n        >\n            <img src={track.albumUrl} style={{height: '64px', width: '64px'}} alt='album cover' />\n            <div className=\"ml-3\">\n                <div>{track.title}</div>\n                <div className=\"text-muted\">{track.artist}</div>\n            </div>\n        </div>\n    );\n}","import { useState, useEffect } from 'react';\nimport useAuth from './useAuth';\nimport Player from './Player';\nimport TrackSearchResult from './TrackSearchResult';\nimport { Container, Form } from 'react-bootstrap';\nimport SpotifyWebApi from 'spotify-web-api-node';\nimport axios from 'axios';\n\nrequire('dotenv').config()\n\nconst spotifyApi = new SpotifyWebApi({\n\tclientId: process.env.CLIENT_ID,\n});\n\nexport default function Dashboard({ code }) {\n\tconst accessToken = useAuth(code);\n\tconst [search, setSearch] = useState('');\n\tconst [searchResults, setSearchResults] = useState([]);\n\tconst [playingTrack, setPlayingTrack] = useState();\n\tconst [lyrics, setLyrics] = useState('');\n\n\tfunction chooseTrack(track) {\n\t\tsetPlayingTrack(track);\n\t\tsetSearch('');\n\t\tsetLyrics('');\n\t}\n\n\tuseEffect(() => {\n\t\tif (!playingTrack) return;\n\n\t\taxios\n\t\t\t.get('http://localhost:3001/lyrics', {\n\t\t\t\tparams: {\n\t\t\t\t\ttrack: playingTrack.title,\n\t\t\t\t\tartist: playingTrack.artist,\n\t\t\t\t},\n\t\t\t})\n\t\t\t.then((res) => {\n\t\t\t\tsetLyrics(res.data.lyrics);\n\t\t\t});\n\t}, [playingTrack]);\n\n\tuseEffect(() => {\n\t\tif (!accessToken) return;\n\t\tspotifyApi.setAccessToken(accessToken);\n\t}, [accessToken]);\n\n\tuseEffect(() => {\n\t\tif (!search) return setSearchResults([]);\n\t\tif (!accessToken) return;\n\n\t\tlet cancel = false;\n\t\tspotifyApi.searchTracks(search).then((res) => {\n\t\t\tif (cancel) return;\n\t\t\tsetSearchResults(\n\t\t\t\tres.body.tracks.items.map((track) => {\n\t\t\t\t\tconst smallestAlbumImage = track.album.images.reduce(\n\t\t\t\t\t\t(smallest, image) => {\n\t\t\t\t\t\t\tif (image.height < smallest.height) return image;\n\t\t\t\t\t\t\treturn smallest;\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttrack.album.images[0]\n\t\t\t\t\t);\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\tartist: track.artists[0].name,\n\t\t\t\t\t\ttitle: track.name,\n\t\t\t\t\t\turi: track.uri,\n\t\t\t\t\t\talbumUrl: smallestAlbumImage.url,\n\t\t\t\t\t};\n\t\t\t\t})\n\t\t\t);\n\t\t});\n\n\t\treturn () => (cancel = true);\n\t}, [search, accessToken]);\n\n\treturn (\n\t\t<Container className=\"d-flex flex-column py-2\" style={{ height: '100vh' }}>\n\t\t\t<Form.Control\n\t\t\t\ttype=\"search\"\n\t\t\t\tplaceholder=\"Search Songs/Artists\"\n\t\t\t\tvalue={search}\n\t\t\t\tonChange={(e) => setSearch(e.target.value)}\n\t\t\t/>\n\t\t\t<div className=\"flex-grow-1 my-2\" style={{ overflowY: 'auto' }}>\n\t\t\t\t{searchResults.map((track) => (\n\t\t\t\t\t<TrackSearchResult\n\t\t\t\t\t\ttrack={track}\n\t\t\t\t\t\tkey={track.uri}\n\t\t\t\t\t\tchooseTrack={chooseTrack}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t\t{searchResults.length === 0 && (\n\t\t\t\t\t<div className=\"text-center\" style={{ whiteSpace: 'pre' }}>\n\t\t\t\t\t\t{lyrics}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<Player accessToken={accessToken} trackUri={playingTrack?.uri} />\n\t\t\t</div>\n\t\t</Container>\n\t);\n}\n","import { useState, useEffect } from 'react';\nimport axios from 'axios'\n\nexport default function useAuth(code) {\n    const [accessToken, setAccessToken] = useState()\n    const [refreshToken, setRefreshToken] = useState()\n    const [expiresIn, setExpiresIn] = useState()\n\n    useEffect(() => {\n        axios\n            .post('http://localhost:3001/login', {\n                code,\n            })\n            .then(res => {\n                setAccessToken(res.data.accessToken)\n                setRefreshToken(res.data.refreshToken)\n                setExpiresIn(res.data.expiresIn)\n                window.history.pushState({}, null, '/')\n            })\n            .catch(() => {\n                window.location = '/'\n            })\n    }, [code])\n\n    useEffect(() => {\n        if (!refreshToken || !expiresIn) return\n        const interval = setInterval(() => {\n\n            axios\n                .post('http://localhost:3001/refresh', {\n                    refreshToken,\n                })\n                .then(res => {\n                    setAccessToken(res.data.accessToken)\n                    setExpiresIn(res.data.expiresIn)\n                })\n                .catch(() => {\n                    window.location = '/'\n                })\n        }, (expiresIn - 60) * 1000)\n        \n        return () => clearInterval(interval)\n    }, [refreshToken, expiresIn])\n\n    return accessToken\n}","import 'bootstrap/dist/css/bootstrap.min.css'\nimport Login from './Login'\nimport Dashboard from './Dashboard'\n\nconst code = new URLSearchParams(window.location.search).get('code')\n\nfunction App() {\n    return code ? <Dashboard code={code} /> : <Login />\n}\n\nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}